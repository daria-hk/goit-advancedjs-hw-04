{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '46483987-c8443b8397d1fa46fa83b5f89';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nasync function getImg(params) {\n    const searchParams = new URLSearchParams({\n        key: API_KEY,\n        q: params.q,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n        page: params.page,\n        per_page: params.per_page,\n        maxPage: 1\n    });\n\n    try {\n        const res = await axios.get(`?${searchParams.toString()}`);\n\n        return res.data;\n    } catch (error) {\n        console.error( error);\n        throw error;\n    }\n}\n\nexport { getImg };\n","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nlet galleryLightbox;\n\nfunction createCardsMarkup(cards) {\n  const cartItem = cards\n    .map(\n      ({ tags, webformatURL, largeImageURL, likes, views, comments, downloads }) => `\n      <li class=\"gallery-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            <div class=\"values-container\">\n                <ul class=\"labels\">\n                    <li>Likes</li>\n                    <li>${likes}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Views</li>\n                    <li>${views}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Comments</li>\n                    <li>${comments}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Downloads</li>\n                    <li>${downloads}</li>\n                </ul>\n            </div>\n        </a>\n      </li>`\n    )\n    .join('');\n    \n    loadSimpleLitebox(cartItem);\n    return cartItem;\n}\n\nfunction loadSimpleLitebox(cartItem) {\n    //const gallery = document.querySelector(\"ul.images-div\");\n    //gallery.innerHTML = cartItem; \n\n    if (galleryLightbox) {\n        galleryLightbox.refresh();\n    } else {\n        galleryLightbox = new SimpleLightbox(\".images-div a\", {\n        captionsData: \"alt\",\n        captionDelay: 250,\n        });\n    }\n}\n\nexport { createCardsMarkup, loadSimpleLitebox };\n","import { getImg } from \"./js/pixabay-api\";\nimport { createCardsMarkup, loadSimpleLitebox } from \"./js/render-functions\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst fetchUsersBtn = document.querySelector(\"input[type=submit]\");\nconst imgs = document.querySelector(\"ul.images-div\");\nconst loaderClass = document.querySelector(\".loaderClass\");\nconst loadMore = document.querySelector(\".load-more\");\n\nconst params = {\n  page: 1,\n  per_page: 15,\n  maxPage: 1,\n  q: '',\n};\n\nloadMore.addEventListener(\"click\", handleLoadmore);\nfetchUsersBtn.addEventListener(\"click\", handleSearch);\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  \n  const searchInput = document.querySelector('input[name=\"search\"]');\n  const notFoundTextEl = document.querySelector(\".not-found-el\");\n\n  params.page = 1;\n  const searchValue = searchInput.value.trim();\n\n  if (searchValue === '') {\n    iziToast.show({\n      title: \"Error\",\n      message: \"Please enter a valid search query!\",\n      color: \"red\",\n    });\n    return;\n  }\n\n  params.q = searchValue;\n\n  loaderClass.style.display = \"flex\";\n  console.log(\"Loader shown\");\n  \n\n  try {\n    const data = await getImg(params);\n\n    const total_pages = Math.ceil(data.totalHits / params.per_page);\n\n    if (data.totalHits === 0) {\n      imgs.innerHTML = \"\";\n      notFoundTextEl.innerHTML = `Results for query <span>${searchValue}</span> not found!`;\n      iziToast.show({\n        title: \"Error\",\n        message: \"No images found for this query. Try again!\",\n        backgroundColor: \"#B51B1B\",\n        messageColor: \"white\",\n        titleColor: \"yellow\",\n      });\n      return;\n    }\n\n    params.maxPage = total_pages;\n\n    imgs.innerHTML = createCardsMarkup(data.hits);\n    loadMore.style.display = params.page < params.maxPage ? \"flex\" : \"none\";\n\n    await handleImageLoading();\n    loadSimpleLitebox(); \n\n  } catch (error) {\n    console.error(\"Error fetching images:\", error);\n    iziToast.show({\n      title: \"Error\",\n      message: \"An error occurred while fetching images. Please try again later.\",\n      color: \"red\",\n    });\n  } finally {\n    loaderClass.style.display = \"none\";\n    console.log(\"Loader hidden\");\n  }\n}\n\nasync function handleLoadmore() { \n  params.page += 1;\n\n  try {\n    loaderClass.style.display = \"flex\";\n    const data = await getImg(params);\n\n    const imgsMarkup = createCardsMarkup(data.hits);\n    imgs.insertAdjacentHTML(\"beforeend\", imgsMarkup);\n\n    await handleImageLoading();\n    loadSimpleLitebox();\n    scrollByCards()\n\n    if (params.page >= params.maxPage) {\n      iziToast.show({\n      title: \"Info\",\n      message: \"We're sorry, but you've reached the end of search results.\",\n      color: \"blue\",\n      });\n      loadMore.style.display = \"none\";\n    }\n    \n  } catch (error) {\n    console.error(\"Error loading more images:\", error);\n    iziToast.show({\n      title: \"Error\",\n      message: \"Failed to load more images. Please try again.\",\n      color: \"red\",\n    });\n  } finally {\n    loaderClass.style.display = \"none\";\n    console.log(\"Loader hidden\");\n  }\n}\n\n\nfunction scrollByCards() {\n  const galeryCard = document.querySelector(\".gallery-card\");\n\n  window.scrollBy({\n     top: galeryCard.height * 2,\n     behavior: \"smooth\" \n  });\n}\n\nasync function handleImageLoading() {\n  const imageElements = document.querySelectorAll(\".gallery-img\");\n    const loadPromises = Array.from(imageElements).map((img) => {\n      return new Promise((resolve) => {\n        img.onload = resolve;\n        img.onerror = resolve;\n      });\n    });\n\n  Promise.all(loadPromises)\n    .then(() => {\n      console.log(loadPromises);\n    })\n    .catch((err) => {\n      loaderClass.innerHTML = \"\";\n      console.error(err);\n    });\n}\n\n"],"names":["API_KEY","axios","getImg","params","searchParams","error","galleryLightbox","createCardsMarkup","cards","cartItem","tags","webformatURL","largeImageURL","likes","views","comments","downloads","loadSimpleLitebox","SimpleLightbox","fetchUsersBtn","imgs","loaderClass","loadMore","handleLoadmore","handleSearch","evt","searchInput","notFoundTextEl","searchValue","iziToast","data","total_pages","handleImageLoading","imgsMarkup","scrollByCards","galeryCard","imageElements","loadPromises","img","resolve","err"],"mappings":"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"}